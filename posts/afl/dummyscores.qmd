---
title: "Dummyscores"
format: html
editor: visual
---

```{r}
# Load necessary library
set.seed(123)  # Set seed for reproducibility

# Teams list
teams <- c("Collingwood Magpies", "Brisbane Lions", "Port Adelaide", "Melbourne Demons",
           "Carlton FC", "St Kilda FC", "Sydney Swans", "Western Bulldogs", "Richmond Tigers",
           "Gold Coast Suns", "Essendon FC", "Fremantle FC", "Hawthorn Hawks",
           "North Melbourne", "West Coast Eagles")

# Function to generate dummy data
generate_afl_data <- function(year) {
  win_count <- sample(2:18, 15, replace = TRUE)  # Random win count between 2 and 18
  lose_count <- 22 - win_count  # Total games played is 22, so lose count is calculated
  tie_count <- sample(0:1, 15, replace = TRUE)  # Random tie count (0 or 1)
  points <- win_count * 4  # Points based on win count (4 points per win)
  
  data.frame(
    Team = teams,
    Season = year,
    Points = points,
    Win_Count = win_count,
    Lose_Count = lose_count,
    Tie_Count = tie_count
  )
}

# Generate data for years 2024 to 2028
afl_data_2024 <- generate_afl_data(2024)
afl_data_2025 <- generate_afl_data(2025)
afl_data_2026 <- generate_afl_data(2026)
afl_data_2027 <- generate_afl_data(2027)
afl_data_2028 <- generate_afl_data(2028)

# Combine all the data
afl_dummy_data <- rbind(afl_data_2024, afl_data_2025, afl_data_2026, afl_data_2027, afl_data_2028)

# Display the generated data
print(afl_dummy_data)

```
```{r}
# Load necessary libraries
library(ggplot2)
library(ggimage)
library(grid)  # For rasterGrob to add the image as background
library(png)   # For reading PNG images
```


```{r}


# Define a function to create the plot for a given team
create_team_plot <- function(team_name) {
  # Filter the team's data from the dataset
  team_data <- afl_dummy_data[afl_dummy_data$Team == team_name, ]
  
  # Create a dot plot with curved black lines for the team's points across the years
  p <- ggplot() +
    # Background rectangle
    geom_rect(aes(xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf), 
              fill = "lightgrey", alpha = 0.2) +  # Light grey background with transparency
    
    # Dots for points
    geom_point(data = team_data, aes(x = as.factor(Season), y = Points, group = 1), size = 5, color = "blue") +
    
    # Curved black line connecting the dots
    geom_smooth(data = team_data, aes(x = as.factor(Season), y = Points, group = 1), 
                method = "loess", se = FALSE, color = "black", linetype = "solid", size = 1.2) +
    
    # Text labels for points
    geom_text(data = team_data, aes(x = as.factor(Season), y = Points, label = Points), 
              vjust = -1.5, size = 5, color = "black") +
    
    # Labels and title
    labs(title = paste(team_name, "Points (2024â€“2028)"),
         x = "Season",
         y = "Points") +
    
    # Clean theme
    theme_minimal(base_size = 16) +  
    theme(
      plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
      axis.title = element_text(face = "bold", size = 16),
      axis.text = element_text(size = 14)
    )
  
  return(p)
}

# List of all teams
all_teams <- unique(afl_dummy_data$Team)

# Create a list to store plots
team_plots <- list()

# Generate plots for all teams
for (team in all_teams) {
  team_plots[[team]] <- create_team_plot(team)
  
  # Display the plots (optional)
  print(team_plots[[team]])
  
  # Optionally save the plots to files
  ggsave(paste0(team, "_Points.png"), plot = team_plots[[team]], width = 12, height = 8, dpi = 300)
}


```

